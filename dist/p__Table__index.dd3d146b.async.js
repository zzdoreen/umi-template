(self.webpackChunk=self.webpackChunk||[]).push([[311],{51744:function(on,oe,d){"use strict";d.r(oe),d.d(oe,{default:function(){return rn}});var ce=d(97857),j=d.n(ce),fe=d(5574),R=d.n(fe),ve=d(97462),me=d(64317),he=d(90672),A=d(14726),w=d(2453),S=d(67294),pe=d(9783),ge=d.n(pe),xe=d(13769),W=d.n(xe),Ce=d(19632),Fe=d.n(Ce),ye=d(68795),je=d(24969),le=d(56766),ue=d(28248),J=d(71230),Se=d(15746),be=d(93967),Pe=d.n(be),Te=d(30381),H=d.n(Te),ie={table:"table___Im2wl",modal:"modal___ch0td",form:"form___owcUY"},Q=d(92210),a=d(85893),Ae=["onSubmit","modal","setModal","hasRestFooter","refreshTime","modelProps","onCancel"],Ee=["searchSpan","extraActions","addText","addButtonProps","hideSearchButton","className","actionRef","setModal"],Ie={title:"\u5E8F\u53F7",valueType:"index",key:"index",width:100,render:function(n,o,u,c){var v=c.pageInfo,p=v===void 0?{}:v,h=p.pageSize,C=h===void 0?0:h,f=p.current,x=f===void 0?1:f;return(0,a.jsx)("div",{style:{padding:"5px 0"},children:x*C+u+1-C})}};function De(e){var n=e.columns,o=e.request,u=e.showIndexColumn,c=u===void 0?!0:u,v=(0,S.useMemo)(function(){return(c?[Ie].concat(Fe()(n)):n).map(function(r){return(0,Q.T)({align:r.valueType==="option"?"center":void 0,fieldProps:{allowClear:r.valueType!=="digit"?!0:void 0,placeholder:null},filters:void 0},r)})},[n]),p=(0,S.useRef)(),h=(0,S.useCallback)(function(r){var g;return(g=p.current)===null||g===void 0?void 0:g.reload(r)},[p]),C=(0,S.useState)({visible:!1}),f=R()(C,2),x=f[0],y=f[1];return{setModal:y,modal:x,reload:h,proTableProps:{request:o,columns:v,setModal:y,actionRef:p,rowKey:"id"},proFormModalProps:{modal:x,setModal:y,columns:v}}}function Re(e){var n=e.onSubmit,o=e.modal,u=e.setModal,c=e.hasRestFooter,v=c===void 0?!1:c,p=e.refreshTime,h=p===void 0?{flag:!1,name:"createdAt"}:p,C=e.modelProps,f=e.onCancel,x=f===void 0?!1:f,y=W()(e,Ae),r=(0,S.useRef)();(0,S.useEffect)(function(){var t=null,s=o.isAdd,m=o.visible,P=o.title;return(s||P==="\u5904\u7406")&&h.flag&&m&&(t=setInterval(function(){var L,Z;return(L=r.current)===null||L===void 0?void 0:L.setFieldsValue(j()(j()({},(Z=r.current)===null||Z===void 0?void 0:Z.getFieldsValue()),{},ge()({},h==null?void 0:h.name,H()())))},1e3)),function(){t&&clearInterval(t)}},[o.visible,o.isAdd,h,o.title]),(0,S.useEffect)(function(){u(function(t){return j()(j()({},t),{},{isAdd:!o.defaultFormValues})})},[o.visible,o.defaultFormValues]),(0,S.useEffect)(function(){var t=o.visible,s=o.defaultFormValues;if(t){var m,P;(m=r.current)===null||m===void 0||m.resetFields(),s&&((P=r.current)===null||P===void 0||P.setFieldsValue(s))}},[o.visible,o.defaultFormValues]);var g=(0,S.useMemo)(function(){return(0,Q.T)({form:{layout:"horizontal",labelCol:{span:6},submitter:!1}},y)},[y]),F=(0,S.useState)(!1),b=R()(F,2),i=b[0],l=b[1];return(0,a.jsx)(ue.Z,j()(j()(j()({visible:o.visible,title:o.title,className:ie.modal,onCancel:function(){var s,m;x&&x((s=r.current)===null||s===void 0?void 0:s.getFieldsValue()),(m=r.current)===null||m===void 0||m.setFieldsValue({file:[]}),u({visible:!1})},forceRender:!0,maskClosable:!1,onOk:function(){var s;return(s=r.current)===null||s===void 0?void 0:s.validateFields().then(function(m){return l(!0),n==null?void 0:n(m)}).finally(function(){return l(!1)})},okButtonProps:{loading:i}},v&&{footer:[(0,a.jsx)(A.ZP,{onClick:function(){var s;return(s=r.current)===null||s===void 0?void 0:s.setFieldsValue(j()(j()({},o.defaultFormValues),{},{content:"",result:""}))},children:"\u91CD\u7F6E"},"reset"),(0,a.jsx)(A.ZP,{type:"primary",onClick:function(){var s;return(s=r.current)===null||s===void 0?void 0:s.validateFields().then(function(m){return l(!0),n==null?void 0:n(m)}).finally(function(){return l(!1)})},children:"\u4FDD\u5B58"},"submit")]}),C),{},{children:(0,a.jsx)(le.ZP,j()({type:"form",formRef:r},g))}))}function ke(e){var n=e.searchSpan,o=n===void 0?6:n,u=e.extraActions,c=e.addText,v=e.addButtonProps,p=e.hideSearchButton,h=e.className,C=e.actionRef,f=e.setModal,x=W()(e,Ee),y=(0,Q.T)({options:!1,toolBarRender:!1,actionRef:C,pagination:{size:"default",defaultPageSize:10,showSizeChanger:!0},className:Pe()(ie.table,h),search:{span:o,optionRender:function(g,F,b){return(0,a.jsxs)(J.Z,{justify:"space-between",children:[p?(0,a.jsx)("span",{}):S.cloneElement(b[1],{icon:(0,a.jsx)(ye.Z,{})}),(0,a.jsxs)(Se.Z,{children:[c&&(0,a.jsx)(A.ZP,j()(j()({type:"primary",icon:(0,a.jsx)(je.Z,{}),onClick:function(){return f({visible:!0,title:c})}},v),{},{children:c})),u]})]})}}},x);return(0,a.jsx)(le.ZP,j()({},y))}var ln=d(15009),un=d(99289),Y=d(23089),sn=d(43281),$=d(80854),Le=["current","pageSize","_timestamp"];function se(e,n){return(0,$.request)(e,{method:"POST",data:n})}function de(e,n){return(0,$.request)(e,{method:"GET",params:n})}function Ze(e,n){return(0,$.request)(e,{method:"PUT",data:n})}function Be(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,$.request)(e,{method:"DELETE",params:n})}function dn(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return request(e,{method:"DELETE",data:n})}function Ue(e,n){return function(o){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},v=o.current,p=o.pageSize,h=o._timestamp,C=W()(o,Le);return e(j()(j()({pageNum:v,pageSize:p},C),(0,Y.aB)(u))).then(function(f){var x=f.code,y=f.message,r=f.data;x!==0&&n&&n(y);var g=[],F=0;return Array.isArray(r)||!r?(g=r||[],F=g.length):(g=r.list||[],F=r.total||0),{data:g,total:F,success:x===0}})}}function cn(e,n){return function(o){return e(o).then(function(u){var c=u.code,v=u.data;return c===0?n?v.map(n):v:[]})}}var X;function fn(){return q.apply(this,arguments)}function q(){return q=_asyncToGenerator(_regeneratorRuntime().mark(function e(){return _regeneratorRuntime().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!X){o.next=2;break}return o.abrupt("return",X);case 2:return o.abrupt("return",protobuf.load("/protobuf/deliver.proto").then(function(u){var c=u.lookupType("deliver.Authentication"),v=u.lookupType("deliver.Consequence"),p=u.lookupType("deliver.Heartbeat"),h=u.lookupType("deliver.Warning"),C=u.lookupType("deliver.Rain"),f=u.lookupType("deliver.Control"),x=u.lookupType("deliver.Rainfall"),y=u.lookupType("deliver.Judge"),r=u.lookupType("deliver.CalEarlywarning");return X={Authentication:c,Consequence:v,Heartbeat:p,Warning:h,Control:f,Rain:C,Rainfall:x,Judge:y,Earthquake:r}}));case 3:case"end":return o.stop()}},e)})),q.apply(this,arguments)}function we(e){return de("/v1/device/list",e)}function Ne(e){var n=new FormData;return n.append("file",e),se("/import",n)}function Me(e){return de("/export",e)}function $e(e){return se("/device",e)}function Oe(e){return Ze("/device",e)}function Ve(e){return Be("/device",{ids:e})}var ze=d(50888),_=d(2058),ee=d(2487),O=d(26404),Ge=d(75081),V=d(51459),ne={start:"start___IX6wS",loading:"loading___Uwu4z",end:"end___py0oA"};function We(e){var n=e.template,o=e.service,u=e.name,c=e.reload,v=e.tootip,p=e.accept,h=p===void 0?".xls,.xlsx":p,C=e.validator,f=(0,S.useState)(!1),x=R()(f,2),y=x[0],r=x[1],g=(0,S.useState)(T.START),F=R()(g,2),b=F[0],i=F[1],l=(0,S.useState)({success:0,failed:[]}),t=R()(l,2),s=t[0],m=t[1],P=(0,S.useState)([]),L=R()(P,2),Z=L[0],N=L[1],M=(0,S.useRef)(),re=(0,S.useCallback)(function(D,U){return U&&!U(D)?_.Z.LIST_IGNORE:(M.current=D,!1)},[]),z=(0,S.useCallback)(function(){if(!M.current)return w.ZP.error("\u8BF7\u9009\u62E9\u6587\u4EF6\uFF01");i(T.LOADING),o(M.current).then(function(D){var U=D.code,ae=D.data,an=D.message;if(U!==0)throw an;m(ae),i(T.END)}).catch(function(D){w.ZP.error(D||"\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),i(T.START)})},[]),B=(0,S.useCallback)(function(){b===T.END&&(c==null||c(!0)),i(T.START),N([]),M.current=void 0,r(!1)},[b]),k,E;if(b===T.START)k=(0,a.jsxs)(ee.Z,{className:ne.start,children:[(0,a.jsx)(J.Z,{className:"title",children:"\u8BF7\u6309\u6A21\u677F\u6807\u51C6\u683C\u5F0F\u5BFC\u5165\u6570\u636E"}),(0,a.jsx)(J.Z,{className:"template-link",children:(0,a.jsx)(O.Z.Link,{href:n,download:!0,children:"\u4E0B\u8F7D\u5BFC\u5165\u6A21\u677F"})}),(0,a.jsx)(_.Z,{beforeUpload:function(U){return re(U,C)},accept:h,showUploadList:{showRemoveIcon:!1},fileList:Z,onChange:function(U){var ae=U.fileList;return N(ae.slice(-1))},children:(0,a.jsx)(A.ZP,{type:"primary",ghost:!0,children:"\u9009\u62E9\u6587\u4EF6"})}),(0,a.jsx)("span",{className:"tooltip",children:v})]}),E=(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A.ZP,{onClick:B,children:"\u53D6\u6D88"}),(0,a.jsx)(A.ZP,{onClick:z,type:"primary",children:"\u5BFC\u5165"})]});else if(b===T.LOADING)k=(0,a.jsx)(ee.Z,{className:ne.loading,children:(0,a.jsx)(Ge.Z,{indicator:(0,a.jsx)(ze.Z,{style:{fontSize:40},spin:!0}),tip:"\u5BFC\u5165\u4E2D"})}),E=null;else{var I=s,G=I.success,K=I.failed;k=(0,a.jsxs)(ee.Z,{className:ne.end,children:[(0,a.jsxs)(O.Z,{children:["\u5BFC\u5165\u5B8C\u6210\uFF0C\u5B8C\u6210",(0,a.jsx)(O.Z.Text,{style:{padding:"0 4px"},strong:!0,children:G}),"\u6761\uFF0C\u5931\u8D25",(0,a.jsx)(O.Z.Text,{style:{padding:"0 4px"},strong:!0,type:K.length?"danger":void 0,children:K.length}),"\u6761"]}),K.length>0&&(0,a.jsx)(O.Z.Link,{onClick:function(){return He(K,u)},children:"\u4E0B\u8F7D\u5931\u8D25\u65E5\u5FD7"})]}),E=(0,a.jsx)(A.ZP,{onClick:B,type:"primary",children:"\u786E\u5B9A"})}return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{onClick:function(){return r(!0)},children:e.children}),(0,a.jsx)(ue.Z,{title:"\u5BFC\u5165".concat(u),visible:y,maskClosable:!1,footer:E,onCancel:B,children:k})]})}var T=function(e){return e[e.START=0]="START",e[e.LOADING=1]="LOADING",e[e.END=2]="END",e}(T||{});function He(e,n){var o=[["\u884C\u53F7","\u5931\u8D25\u539F\u56E0"]],u=V.utils.aoa_to_sheet(o),c=V.utils.sheet_add_aoa(u,e.map(function(p){var h=p.index,C=p.reason;return[h,C]}),{origin:"A2"}),v=V.utils.book_new();V.utils.book_append_sheet(v,c),(0,V.writeFile)(v,"".concat(n,"\u5BFC\u5165\u5931\u8D25\u65E5\u5FD7").concat(H()().format("YYYYMMDDHHmmss"),".xlsx"))}function vn(e){var n=e.service,o=e.name,u=e.reload,c=e.tootip,v=e.accept,p=v===void 0?".xls,.xlsx":v,h=e.validator,C=useState(!1),f=_slicedToArray(C,2),x=f[0],y=f[1],r=useState(T.START),g=_slicedToArray(r,2),F=g[0],b=g[1],i=useState(!1),l=_slicedToArray(i,2),t=l[0],s=l[1],m=useState([]),P=_slicedToArray(m,2),L=P[0],Z=P[1],N=useRef(),M=useCallback(function(E,I){return I&&!I(E)?Upload.LIST_IGNORE:(N.current=E,!1)},[]),re=useCallback(function(){if(!N.current)return message.error("\u8BF7\u9009\u62E9\u6587\u4EF6\uFF01");b(T.LOADING),n(N.current).then(function(E){var I=E.code,G=E.message;if(s(I===0),I!==0)throw G;b(T.END)}).catch(function(E){message.error(E||"\u5BFC\u5165\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5"),b(T.START)})},[]),z=useCallback(function(){F===T.END&&(u==null||u()),b(T.START),Z([]),N.current=void 0,y(!1)},[F]),B,k;return F===T.START?(B=_jsxs(List,{className:style.start,children:[_jsx(Upload,{beforeUpload:function(I){return M(I,h)},accept:p,fileList:L,onChange:function(I){var G=I.fileList;return Z(G.slice(-1))},children:_jsx(Button,{type:"primary",ghost:!0,children:"\u9009\u62E9\u6587\u4EF6"})}),_jsx("span",{className:"tooltip",children:c})]}),k=_jsxs(_Fragment,{children:[_jsx(Button,{onClick:z,children:"\u53D6\u6D88"}),_jsx(Button,{onClick:re,type:"primary",children:"\u5BFC\u5165"})]})):F===T.LOADING?(B=_jsx(List,{className:style.loading,children:_jsx(Spin,{indicator:_jsx(LoadingOutlined,{style:{fontSize:40},spin:!0}),tip:"\u4E0A\u4F20\u4E2D"})}),k=null):(B=_jsx(List,{className:style.end,children:_jsx(Typography,{children:t?"\u4E0A\u4F20\u5B8C\u6210":"\u4E0A\u4F20\u5931\u8D25"})}),k=_jsx(Button,{onClick:z,type:"primary",children:"\u786E\u5B9A"})),_jsxs(_Fragment,{children:[_jsx("span",{onClick:function(){return y(!0)},children:e.children}),_jsx(Modal,{title:"\u4E0A\u4F20".concat(o),visible:x,maskClosable:!1,footer:k,onCancel:z,children:B})]})}var Ye=d(87077),mn=d(82492),Ke={"upload-image":"upload-image___CcnOj","upload-file":"upload-file___kQOCm"},Je=null,Qe=["value","onChange","onlyShowName","downloadLink"],Xe=null;function qe(e){return Promise.resolve({code:0,message:"",data:e})}var hn=function(n){var o=useState(!1),u=_slicedToArray(o,2),c=u[0],v=u[1],p=useDebounceFn(function(r){return v(!!r)},{wait:200}),h=p.run,C=useMemo(function(){return merge({formItemProps:{normalize:function(g){var F;return(F=g[0])===null||F===void 0?void 0:F.originFileObj},getValueProps:function(g){return h(g),typeof g=="string"?{fileList:[{name:g}]}:g?{fileList:[g]}:void 0},getValueFromEvent:function(g){var F=g.fileList;return F}}},n)},[n]),f=C.formItemProps,x=C.fieldProps,y=_objectWithoutProperties(C,Je);return _jsx(Form.Item,_objectSpread(_objectSpread(_objectSpread({},y),f),{},{className:styles["upload-file"],children:_jsx(Upload,_objectSpread(_objectSpread({},x),{},{beforeUpload:function(){return!1},maxCount:1,showUploadList:c?{showPreviewIcon:!1}:!1,children:_jsx(Button,{children:"\u4E0A\u4F20\u6587\u4EF6"})}))}))},pn=null,_e=function(n){var o=n.value,u=n.onChange,c=n.onlyShowName,v=n.downloadLink,p=W()(n,Qe),h=(0,Ye.Z)({value:o,onChange:u}),C=R()(h,2),f=C[0],x=C[1],y=(0,S.useMemo)(function(){return typeof f=="string"?[{name:f}]:f?[f]:void 0},[f]);return c?(0,a.jsx)("span",{children:o}):(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsx)(_.Z,j()(j()({},p),{},{fileList:y,beforeUpload:function(){return!1},className:Ke["upload-file"],onChange:function(g){var F,b=g.fileList;return x((F=b[0])===null||F===void 0?void 0:F.originFileObj)},maxCount:1,showUploadList:{showPreviewIcon:!1},children:(0,a.jsx)(A.ZP,{children:"\u4E0A\u4F20\u6587\u4EF6"})})),(0,a.jsx)($.Access,{accessible:!!(v&&f),children:(0,a.jsx)(A.ZP,{type:"link",href:v,target:"_blank",children:"\u4E0B\u8F7D\u9644\u4EF6"})})]})},gn=function(n){var o=n.value,u=n.onChange,c=n.maxCount,v=n.batchDownloadFlag,p=v===void 0?!1:v,h=_objectWithoutProperties(n,Xe),C=useControllableValue({value:o,onChange:u}),f=_slicedToArray(C,2),x=f[0],y=f[1],r=useMemo(function(){return x?x.map(function(i){return typeof i=="string"?_objectSpread(_objectSpread({name:nn(i),uid:Math.random(),url:te(i)},i.includes(";")?{fileUrl:i}:{}),{},{status:"done"}):i}):void 0},[x]),g=useCallback(function(i){var l=i.url,t=i.name;return l?en(l,t):message.error("\u6587\u4EF6\u83B7\u53D6\u5931\u8D25")},[]),F=function(){r!=null&&r.length&&r.forEach(function(l){var t=l.url,s=l.name,m=document.createElement("iframe");m.style.display="none";var P=document.createElement("a");P.href=window.location.origin+t,P.type="download",P.download=s,m.appendChild(P),P.click(),document.body.appendChild(m),setTimeout(function(){m.remove()},10*60*1e3)})},b=function(l){return y(l==null?void 0:l.map(function(t){var s,m;return t.url?t:{response:t.response,status:(t==null||(s=t.response)===null||s===void 0?void 0:s.code)===0?"done":"error",uid:t.uid,name:t.name,url:t==null||(m=t.response)===null||m===void 0?void 0:m.data}}))};return _jsxs("div",{style:{position:"relative"},children:[_jsx(Upload,_objectSpread(_objectSpread(_objectSpread({},h),{},{headers:{Authorization:"Bearer "+getLocalStorage("token")},fileList:r},c?{maxCount:c}:{}),{},{beforeUpload:function(){var l,t=(l=r==null?void 0:r.length)!==null&&l!==void 0?l:0;return c&&c<=t?(message.info("\u6700\u591A\u4E0A\u4F20".concat(c,"\u4E2A")),!1):!0},onChange:function(l){var t=l.fileList;return b(t)},multiple:!0,showUploadList:{showPreviewIcon:!0,showDownloadIcon:p,showRemoveIcon:!0},onPreview:function(l){var t=te((l==null?void 0:l.url)||"");return window.open(window.location.origin+t,"_target")},onDownload:g,onRemove:function(l){if(l.url){var t=l!=null&&l.fileUrl?l.fileUrl:l.url;t=t.startsWith("/")?t.slice(1):t,qe(t).then(function(s){var m=s.code,P=s.message;return m===0?!0:(message.error(P),!1)})}return!0},children:_jsx(Button,{children:"\u4E0A\u4F20\u6587\u4EF6"})})),_jsx(Access,{accessible:p,children:_jsx(Button,{style:{position:"absolute",top:0,right:"-15px"},type:"link",className:"batch-delete-btn",onClick:function(){return F()},children:"\u6279\u91CF\u4E0B\u8F7D"})})]})},en=function(n,o){var u=document.createElement("a");u.style.display="none",u.style.height="0px",u.href=window.location.origin+te(n),u.download=o,document.body.appendChild(u),u.click(),document.body.removeChild(u)},te=function(n){var o=(n==null?void 0:n.split(";").length)>1?n.split(";")[1]:n;return o=o.startsWith("/")?o:"/"+o,o},nn=function(n){return n.split("/")[n.split("/").length-1].split("_").slice(1).join("_")},tn=function(){var n=(0,S.useRef)(),o=(0,S.useState)([]),u=R()(o,2),c=u[0],v=u[1],p=(0,S.useMemo)(function(){return[{title:"\u540D\u79F0",dataIndex:"deviceId",tip:"\u540D\u79F0\u662F\u552F\u4E00\u7684 key",search:!1},{title:"\u679A\u4E3E\u7C7B\u578B",dataIndex:"market",valueEnum:(0,Y.KP)([{label:"\u7C7B\u578B\u4E00",value:1},{label:"\u7C7B\u578B\u4E8C",value:2}]),formItemProps:{rules:[{required:!0}]},fieldProps:{mode:"multiple"}},{title:"\u6392\u5E8F",dataIndex:"market",search:!1,valueType:"digit",formItemProps:{rules:[{required:!0}]},width:100,fieldProps:{precision:0,min:1}},{title:function(l,t){return t==="form"?"emm form":"emm table"},dataIndex:"market",search:!1,renderFormItem:function(){return(0,a.jsx)(ve.Z,{name:["market"],children:function(t){var s=t.market;return s===1||Array.isArray(s)&&s[0]===1?(0,a.jsx)(me.Z,{name:"type",options:[{label:"\u7C7B\u578B\u4E00",value:1},{label:"\u7C7B\u578B\u4E8C",value:2}]}):(0,a.jsx)(he.Z,{name:"note",rules:[{required:!0},{max:15}]})}})}},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updatedAt",render:Y.Pj,hideInForm:!0,width:200,valueType:"dateRange",search:{transform:function(l){var t=R()(l,2),s=t[0],m=t[1];return{startAt:H()(s).startOf("day").unix(),endAt:H()(m).endOf("day").unix()}}}},{title:"\u6587\u4EF6",dataIndex:"file",search:!1,formItemProps:{rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u56FE\u7247"}]},renderFormItem:function(){return(0,a.jsx)(_e,{accept:".png"})},renderText:function(l){return(0,a.jsx)(A.ZP,{type:"link",target:"_blank",href:l,children:l})}},{dataIndex:"id",hideInTable:!0,search:!1,formItemProps:{hidden:!0}},{title:"\u64CD\u4F5C",valueType:"option",width:200,render:function(l,t){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A.ZP,{type:"link",onClick:function(){return x({visible:!0,defaultFormValues:j()(j()({},t),{},{file:"http://xxx.png"}),title:"\u7F16\u8F91"})},children:"\u7F16\u8F91"}),(0,a.jsx)(A.ZP,{type:"link",danger:!0,onClick:function(){return b(t==null?void 0:t.deviceId)},children:"\u5220\u9664"})]})}}]},[]),h=De({columns:p,request:Ue(we)}),C=h.proTableProps,f=h.proFormModalProps,x=h.setModal,y=h.reload,r=h.modal,g=(0,S.useCallback)(function(i){var l=r!=null&&r.isAdd?$e(i):Oe(i);return l.then(function(t){var s=t.code,m=t.message;s===0?(w.ZP.success("".concat(r!=null&&r.isAdd?"\u65B0\u589E":"\u7F16\u8F91","\u6210\u529F")),y(r==null?void 0:r.isAdd),x({visible:!1})):w.ZP.error(m||"\u64CD\u4F5C\u5931\u8D25")})},[r==null?void 0:r.isAdd]),F=(0,S.useMemo)(function(){return f.columns.map(function(i){return i.dataIndex==="status"?j()(j()({},i),{},{initialValue:1,valueType:"radio"}):i})},[f.columns]),b=(0,S.useCallback)(function(i){(0,Y.WZ)({content:i?"\u786E\u5B9A\u5220\u9664\u6B64\u6570\u636E\u5417?":"\u786E\u5B9A\u5220\u9664\u9009\u4E2D\u7684".concat(c==null?void 0:c.length,"\u9879?"),onOk:function(){Ve(i?[i]:c).then(function(t){var s=t.code,m=t.message;s===0?(w.ZP.success("\u5220\u9664\u6210\u529F"),v([]),y(!0)):w.ZP.error(m||"\u5220\u9664\u5931\u8D25")})}})},[c]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ke,j()(j()({},C),{},{searchSpan:6,addText:"\u65B0\u5EFA",rowKey:"deviceId",beforeSearchSubmit:function(l){return n.current=l,l},extraActions:[(0,a.jsx)(We,{name:"\u5BFC\u5165",template:"",service:Ne,reload:y,accept:".xlsx",tootip:"\u4EC5\u652F\u6301xlsx\u683C\u5F0F\u6587\u4EF6\uFF0C\u6587\u4EF6\u5C0F\u4E8E30MB",validator:function(l){return l.size>30*1024*1024||!/.xlsx$/.test(l.name)?(w.ZP.error("\u4EC5\u652F\u6301xlsx\u683C\u5F0F\u6587\u4EF6\uFF0C\u6587\u4EF6\u5C0F\u4E8E30MB"),!1):!0},children:(0,a.jsx)(A.ZP,{type:"primary",children:"\u5BFC\u5165\u6570\u636E"})},"upload"),(0,a.jsx)(A.ZP,{type:"primary",onClick:function(){return Me(j()({},n.current))},children:"\u5BFC\u51FA"},"export"),(0,a.jsx)(A.ZP,{danger:!0,disabled:c.length<=0,type:"primary",onClick:function(){return b()},children:"\u6279\u91CF\u5220\u9664"},"batchDel")],scroll:{y:480},rowSelection:{onChange:function(l){return v(l)},selectedRowKeys:c,getCheckboxProps:function(){return{disabled:!1}}}})),(0,a.jsx)(Re,j()(j()({},f),{},{columns:F,onSubmit:g}))]})},rn=tn},18685:function(){}}]);
