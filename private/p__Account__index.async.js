"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[547],{9700:function(te,O,e){e.d(O,{MU:function(){return P},dd:function(){return g}});var C=e(60522),p=e(64665),A=e(23435),T=e(167),W=e(63372),M=e(49956),E=e(78537),B=e(75171),U=e(84636),K=e(50838),r=e(69514),y=e(41151),j=e(28465),I=e(7162),c=e(35183),L=e(53370),N=e(31648),R=e(6228),D=e(67294);c.D([p.N,A.N,T.N,W.N,M.N,E.N,B.N,U.N,K.N,r.N,y.N,R.N,j.N,I.N]);function g(o){var _=(0,C.Z)(o);(0,D.useEffect)(function(){var n;o.current&&((n=L.JE(o.current))===null||n===void 0||n.resize())},[_])}function P(o,_){(0,D.useEffect)(function(){if(!o.current)return;var n=L.S1(o.current);n.setOption(_);function x(){n==null||n.resize()}return window.addEventListener("resize",x),function(){n.dispose(),window.removeEventListener("resize",x)}},[])}O.ZP=N},49298:function(te,O,e){e.r(O),e.d(O,{default:function(){return y}});var C=e(5574),p=e.n(C),A=e(40411),T=e(89557),W=e(30381),M=e.n(W),E=e(67294),B=e(9700),U=e(78957),K=e(80854),r=e(85893);function y(){var j=(0,E.useState)(1),I=p()(j,2),c=I[0],L=I[1],N=(0,E.useState)(M()()),R=p()(N,2),D=R[0],g=R[1],P=(0,E.useRef)(null),o=(0,K.useModel)("@@initialState",function(s){var t=s.initialState;return t==null?void 0:t.data}),_=(0,E.useMemo)(function(){for(var s=D.get("year")===M()().get("year"),t=s?M()().get("month")+1:12,i=[["month"]],u=[],a=[],d=0,v=0,w=0,z=1;z<=t;z++){var re="".concat(D.get("year"),"-").concat(z);i[0].push(re)}return i[0].forEach(function(l,k){var F,Z,Y,b,G,J,f,m,X;if(k!==0){u.push([l,(F=o[l])===null||F===void 0?void 0:F.expenditure.total]),a.push([l,(Z=o[l])===null||Z===void 0?void 0:Z.income]);var q=(((Y=o[l])===null||Y===void 0?void 0:Y.income)-((b=o[l])===null||b===void 0?void 0:b.expenditure.total)).toFixed(1)-0;d+=isNaN(q)?0:q,v+=isNaN((G=o[l])===null||G===void 0?void 0:G.income)?0:(J=o[l])===null||J===void 0?void 0:J.income,w+=isNaN((f=o[l])===null||f===void 0||(f=f.expenditure)===null||f===void 0?void 0:f.total)?0:(m=o[l])===null||m===void 0||(m=m.expenditure)===null||m===void 0?void 0:m.total;for(var H=Object.keys(((X=o[l])===null||X===void 0?void 0:X.expenditure)||[]).splice(1),h=0;h<H.length;h++){var Q,ee=((Q=o[l])===null||Q===void 0?void 0:Q.expenditure[H[h]])||0;k===1?i.push([H[h],ee]):i[h+1].push(ee)}}}),{source:i,expenditures:u,incomes:a,totalIncome:v.toFixed(1),totalSurplus:d.toFixed(1),totalExpenditures:w.toFixed(1)}},[D]),n=_.source,x=_.expenditures,S=_.incomes,V=_.totalSurplus,ne=_.totalIncome,oe=_.totalExpenditures,$=(0,E.useMemo)(function(){return{legend:{},tooltip:{trigger:"axis",confine:!0},dataset:{source:n},xAxis:{type:"category",axisLabel:{formatter:function(t){return t.split(" ").join(`

`)}}},title:{text:n[0][c]+`

`+n.reduce(function(s,t){return s+=typeof t[c]=="number"?t[c]:0},0),left:"center",top:"18%"},yAxis:{gridIndex:0},grid:{top:"55%"},series:n.map(function(s,t){return t===n.length-1?{type:"pie",id:"pie",radius:["20%","30%"],center:["50%","25%"],emphasis:{focus:"self"},label:{formatter:"{b}: {@".concat(n[0][c],"} ({d}%)")},encode:{itemName:n[0][0],value:n[0][c],tooltip:n[0][c]}}:{type:"line",smooth:!0,stack:"Total",areaStyle:{},seriesLayoutBy:"row",emphasis:{focus:"series"}}}).concat(S[0][1]?[{type:"bar",name:"\u6536\u5165",data:S,label:{show:!0,position:"top"},barWidth:15,barGap:"20%"},{type:"line",name:"\u82B1\u8D39",label:{show:!0,position:"top"},data:x},{type:"pie",id:"statistic",name:"-",radius:"30%",center:["30%","25%"],data:n.slice(1).map(function(s){var t=[s[0],s.slice(1).reduce(function(a,d){return a+(isNaN(d)?0:d)},0)],i=t[0],u=t[1];return{value:u.toFixed(1),name:i}}),emphasis:{focus:"self"},label:{formatter:"{b}: {@".concat(n[0][c],"} ({d}%)")}}]:[]),dataZoom:[{type:"inside",zoomOnMouseWheel:!0,moveOnMouseWheel:!0,moveOnMouseMove:!0}]}},[n,x,S,c]);(0,E.useEffect)(function(){if(!P.current)return;var s=B.ZP.init(P.current);s.on("updateAxisPointer",function(i){var u=i.axesInfo[0];if(u){var a=u.value+1;s.setOption({title:{text:n[0][a]+`

`+n.reduce(function(d,v){return d+=typeof v[a]=="number"?v[a]:0},0),left:"center",top:"18%"},series:{id:"pie",label:{formatter:"{b}: {@["+a+"]} ({d}%)"},encode:{value:a,tooltip:a}}})}}),s.setOption($);function t(){s==null||s.resize()}return window.addEventListener("resize",t),function(){s.dispose(),window.removeEventListener("resize",t)}},[$]);var se=function(t){var i=t.format("YYYY-M");if(t.clone().unix()<=M()().unix()&&o[i]){var u,a,d,v=(((u=o[i])===null||u===void 0?void 0:u.income)-((a=o[i])===null||a===void 0||(a=a.expenditure)===null||a===void 0?void 0:a.total)).toFixed(1);return(0,r.jsxs)("ul",{style:{listStyleType:"none"},children:[(0,r.jsx)("li",{children:(0,r.jsx)(A.Z,{status:"success",text:"\u{1F911}\uFF1A".concat((d=o[i])===null||d===void 0?void 0:d.income)})}),(0,r.jsx)("li",{children:(0,r.jsx)(A.Z,{status:"error",text:"\u{1F608}\uFF1A".concat(o[i].expenditure.total)})}),(0,r.jsx)("li",{style:{color:v>0?"green":"red"},children:v})]})}return null};return(0,r.jsxs)("div",{className:"account",children:[(0,r.jsx)("br",{}),(0,r.jsxs)(U.Z,{size:"large",children:["\xA0 \xA0 \xA0",(0,r.jsxs)("span",{children:["+ ",ne]}),(0,r.jsxs)("span",{children:["- ",oe]}),(0,r.jsx)("span",{style:{color:+V>0?"green":"red"},children:V})]}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)(T.Z,{mode:"year",onChange:g,cellRender:se,onSelect:function(t){return L((t==null?void 0:t.month())+1)},disabledDate:function(t){return t.clone().unix()>M()().unix()}}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("div",{ref:P,className:"statistic",style:{width:"100%",height:500}})]})}}}]);
